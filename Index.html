<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="BodyShape">
    <title>Body Shape Coach</title>
    
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='background:%23ff4757'%3E%3Cpath fill='%23ffffff' d='M256 48C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48zm-32.1 289.8l-8.8 45.3c-2.1 10.7-16.5 13.6-22.7 4.6l-37.5-54.6c-5.8-8.4-5.4-19.6 1-27.6l74.9-93.6c7.9-9.9 23.4-4.8 24.3 7.9l3.3 46.1 45.1-66.2c6.1-8.9 19.3-8.6 25 0l42.6 62.4c5.8 8.5 5.2 19.7-1.3 27.6l-81.5 98.7c-8.4 10.2-24.6 4.8-25.3-8.3l-2.6-47.5-36.5 5.2z'/%3E%3C/svg%3E">

    <style>
        :root {
            --primary: #ff4757;
            --dark: #1e272e;
            --light: #f1f2f6;
            --success: #2ed573;
            --warning: #ffa502;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--dark);
            color: white;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            /* Safe Area f√ºr iPhone X/11/12/13/14/15 */
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- Screens --- */
        .screen {
            display: none;
            flex-direction: column;
            height: 100%;
            padding: 20px;
            box-sizing: border-box;
            text-align: center;
        }

        .active { display: flex; }

        /* --- Home Screen --- */
        h1 { margin-bottom: 5px; color: var(--primary); text-transform: uppercase; letter-spacing: 2px; margin-top: 20px;}
        p.subtitle { color: #a4b0be; margin-top: 0; font-size: 0.9rem; margin-bottom: 30px; }
        
        .menu-grid {
            display: grid;
            gap: 15px;
            flex-grow: 1;
            align-content: center;
            overflow-y: auto;
        }

        .btn-workout {
            background: #344050;
            border: none;
            padding: 20px;
            border-radius: 18px;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
            text-align: left;
            position: relative;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .btn-workout:active { transform: scale(0.96); background: #455263; }
        .btn-workout span { display: block; font-size: 0.8rem; color: #ced6e0; font-weight: normal; margin-top: 5px; }
        
        /* --- Workout Screen --- */
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; margin-top: 10px; }
        .btn-small { background: rgba(255,255,255,0.1); border: none; color: #ccc; padding: 8px 15px; border-radius: 20px; font-size: 0.9rem; }

        .timer-display {
            background: var(--dark);
            border: 6px solid var(--primary);
            width: 220px;
            height: 220px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 5rem;
            font-weight: 800;
            font-variant-numeric: tabular-nums; /* Verhindert Wackeln der Zahlen */
            margin: 10px auto 20px auto;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
            transition: border-color 0.3s, color 0.3s;
        }

        .phase-text { font-size: 1.8rem; font-weight: 900; text-transform: uppercase; margin-bottom: 5px; color: var(--success); letter-spacing: 1px;}
        .exercise-name { font-size: 1.6rem; margin-bottom: 5px; min-height: 50px; line-height: 1.2; font-weight: 600; padding: 0 10px;}
        .next-exercise { color: #747d8c; font-size: 1rem; margin-bottom: 20px; min-height: 20px; }
        
        .controls { display: flex; justify-content: center; gap: 30px; margin-top: auto; margin-bottom: 40px; }
        .btn-control {
            width: 80px; height: 80px; border-radius: 50%; border: none; font-size: 2rem;
            cursor: pointer; display: flex; justify-content: center; align-items: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            transition: transform 0.1s;
        }
        .btn-control:active { transform: scale(0.9); }
        .btn-play { background: var(--success); color: white; }
        .btn-pause { background: var(--warning); color: white; }

        /* --- Progress Bar --- */
        .progress-container { background: #344050; height: 8px; border-radius: 4px; margin-top: 10px; width: 100%; overflow: hidden;}
        .progress-fill { background: var(--primary); height: 100%; width: 0%; border-radius: 4px; transition: width 0.5s; }

        /* States */
        .state-rest .timer-display { border-color: var(--warning); color: var(--warning); }
        .state-rest .phase-text { color: var(--warning); }
        .state-work .timer-display { border-color: var(--success); color: white; }
        
    </style>
</head>
<body>

    <div id="home-screen" class="screen active">
        <h1>Body Shape</h1>
        <p class="subtitle">Dein 15 Min. Plan</p>
        
        <div class="menu-grid">
            <button class="btn-workout" onclick="startWorkout(0)">
                TAG 1: Po & Beine
                <span>Squats, Bridges, Lunges, Kicks</span>
            </button>
            <button class="btn-workout" onclick="startWorkout(1)">
                TAG 2: Oberk√∂rper
                <span>Push-Ups, Superman, Dips, Angels</span>
            </button>
            <button class="btn-workout" onclick="startWorkout(2)">
                TAG 3: Bauch & Core
                <span>Bicycle, Leg Raises, Plank, Twist</span>
            </button>
        </div>
        <p style="font-size: 0.7rem; color: #57606f; margin-top: 20px;">Zum Home-Bildschirm hinzuf√ºgen</p>
    </div>

    <div id="workout-screen" class="screen">
        <div class="top-bar">
            <button class="btn-small" onclick="quitWorkout()">‚úï Beenden</button>
            <div id="round-indicator" style="font-weight: bold; color: #747d8c;">Runde 1 / 3</div>
        </div>

        <div id="phase-display" class="phase-text">BEREIT MACHEN</div>
        
        <div id="timer" class="timer-display">10</div>

        <div id="current-exercise" class="exercise-name">Warm Up</div>
        <div id="next-exercise" class="next-exercise">Gleich geht's los</div>

        <div class="progress-container">
            <div id="progress-bar" class="progress-fill"></div>
        </div>

        <div class="controls">
            <button id="btn-action" class="btn-control btn-play" onclick="toggleTimer()">‚ñ∂</button>
        </div>
    </div>

    <div id="done-screen" class="screen" style="justify-content: center;">
        <h1 style="font-size: 4rem; margin: 0;">üî•</h1>
        <h2 style="font-size: 2rem; margin: 10px 0;">Stark!</h2>
        <p style="color: #ccc; font-size: 1.1rem; line-height: 1.5;">Training beendet.<br>Erholung ist wichtig.</p>
        <button class="btn-workout" style="text-align: center; margin-top: 40px; background: var(--success);" onclick="quitWorkout()">Zur√ºck zum Men√º</button>
    </div>

    <script>
        // --- DATA ---
        const plans = [
            {
                name: "Tag 1: Po & Beine",
                exercises: ["Kniebeugen (Squats)", "Glute Bridges", "Reverse Lunges", "Donkey Kicks"]
            },
            {
                name: "Tag 2: Oberk√∂rper",
                exercises: ["Liegest√ºtze", "Superman Pull (R√ºcken)", "Trizeps Dips", "Rev. Snow Angels"]
            },
            {
                name: "Tag 3: Bauch & Core",
                exercises: ["Bicycle Crunches", "Leg Raises", "Plank (Halten)", "Russian Twist"]
            }
        ];

        // --- STATE ---
        let currentPlan = null;
        let currentRound = 1;
        let currentExerciseIndex = 0;
        let isWorkPhase = true; 
        let timeLeft = 10;
        let timerInterval = null;
        let isRunning = false;
        let totalRounds = 3;
        
        const WORK_TIME = 40;
        const REST_TIME = 20;

        // --- DOM ---
        const homeScreen = document.getElementById('home-screen');
        const workoutScreen = document.getElementById('workout-screen');
        const doneScreen = document.getElementById('done-screen');
        
        const timerDisplay = document.getElementById('timer');
        const phaseDisplay = document.getElementById('phase-display');
        const exerciseNameDisplay = document.getElementById('current-exercise');
        const nextExerciseDisplay = document.getElementById('next-exercise');
        const roundIndicator = document.getElementById('round-indicator');
        const progressBar = document.getElementById('progress-bar');
        const actionBtn = document.getElementById('btn-action');
        const workoutContainer = document.getElementById('workout-screen');

        // --- LOGIC ---
        function startWorkout(planIndex) {
            currentPlan = plans[planIndex];
            currentRound = 1;
            currentExerciseIndex = 0;
            isWorkPhase = false; 
            timeLeft = 10; 
            isRunning = false;

            updateUI();
            
            homeScreen.classList.remove('active');
            doneScreen.classList.remove('active');
            workoutScreen.classList.add('active');
            
            phaseDisplay.innerText = "BEREIT MACHEN";
            exerciseNameDisplay.innerText = "Start: " + currentPlan.exercises[0];
            nextExerciseDisplay.innerText = "";
            workoutContainer.className = "screen active state-rest";
            
            toggleTimer(); 
        }

        function quitWorkout() {
            clearInterval(timerInterval);
            isRunning = false;
            homeScreen.classList.add('active');
            workoutScreen.classList.remove('active');
            doneScreen.classList.remove('active');
        }

        function finishWorkout() {
            clearInterval(timerInterval);
            workoutScreen.classList.remove('active');
            doneScreen.classList.add('active');
        }

        function toggleTimer() {
            if (isRunning) {
                clearInterval(timerInterval);
                isRunning = false;
                actionBtn.innerText = "‚ñ∂";
                actionBtn.className = "btn-control btn-play";
            } else {
                timerInterval = setInterval(tick, 1000);
                isRunning = true;
                actionBtn.innerText = "‚è∏";
                actionBtn.className = "btn-control btn-pause";
            }
        }

        function tick() {
            if (timeLeft > 0) {
                timeLeft--;
                updateTimerDisplay();
            } else {
                switchPhase();
            }
        }

        function switchPhase() {
            if (!isWorkPhase) {
                // REST -> WORK
                isWorkPhase = true;
                timeLeft = WORK_TIME;
                playBeep(800); 
            } else {
                // WORK -> REST
                isWorkPhase = false;
                timeLeft = REST_TIME;
                playBeep(400); 
                
                currentExerciseIndex++;
                
                if (currentExerciseIndex >= currentPlan.exercises.length) {
                    currentExerciseIndex = 0;
                    currentRound++;
                    if (currentRound > totalRounds) {
                        finishWorkout();
                        return;
                    }
                }
            }
            updateUI();
        }

        function updateUI() {
            updateTimerDisplay();
            roundIndicator.innerText = `Runde ${currentRound} / ${totalRounds}`;
            
            let totalExercises = currentPlan.exercises.length * totalRounds;
            let exercisesDone = ((currentRound - 1) * currentPlan.exercises.length) + currentExerciseIndex;
            let percent = (exercisesDone / totalExercises) * 100;
            progressBar.style.width = percent + "%";

            if (isWorkPhase) {
                workoutContainer.className = "screen active state-work";
                phaseDisplay.innerText = "GO!";
                exerciseNameDisplay.innerText = currentPlan.exercises[currentExerciseIndex];
                
                // Vorschau n√§chste √úbung
                let nextIdx = currentExerciseIndex + 1;
                let nextName = "";
                if (nextIdx < currentPlan.exercises.length) {
                    nextName = currentPlan.exercises[nextIdx];
                } else if (currentRound < totalRounds) {
                    nextName = currentPlan.exercises[0] + " (N√§chste Runde)";
                } else {
                    nextName = "FINISH";
                }
                nextExerciseDisplay.innerText = "Danach: " + nextName;

            } else {
                workoutContainer.className = "screen active state-rest";
                phaseDisplay.innerText = "PAUSE";
                exerciseNameDisplay.innerText = "N√§chste √úbung:";
                nextExerciseDisplay.innerText = currentPlan.exercises[currentExerciseIndex];
                if(timeLeft < 0) timeLeft = 0;
            }
        }

        function updateTimerDisplay() {
            let s = timeLeft;
            timerDisplay.innerText = (s < 10 ? "0" : "") + s;
        }

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playBeep(freq) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.frequency.value = freq;
            osc.type = 'square';
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.3);
            osc.stop(audioCtx.currentTime + 0.3);
        }
    </script>
</body>
</html>
